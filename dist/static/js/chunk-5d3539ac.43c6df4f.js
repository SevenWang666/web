(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5d3539ac"],{"08da":function(e,t,o){},"386d":function(e,t,o){"use strict";var s=o("cb7c"),a=o("83a1"),n=o("5f1b");o("214f")("search",1,function(e,t,o,c){return[function(o){var s=e(this),a=null==o?void 0:o[t];return void 0!==a?a.call(o,s):new RegExp(o)[t](String(s))},function(e){var t=c(o,e,this);if(t.done)return t.value;var i=s(e),r=String(this),l=i.lastIndex;a(l,0)||(i.lastIndex=0);var u=n(i,r);return a(i.lastIndex,l)||(i.lastIndex=l),null===u?-1:u.index}]})},"3c9d":function(e,t,o){e.exports=o.p+"static/img/invoice.d32453a8.png"},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},a36c:function(e,t,o){},a5ae:function(e,t,o){"use strict";var s=o("08da");o.n(s).a},b3c8:function(e,t,o){e.exports=o.p+"static/img/pocket-book.58177120.png"},d7ca:function(e,t,o){"use strict";var s=o("a36c");o.n(s).a},f952:function(e,t,o){"use strict";o.r(t),o("ac4d"),o("8a81"),o("ac6a"),o("96cf");var s,a,n=o("3b8d"),c=(o("a481"),o("386d"),o("3b2b"),o("6b54"),{name:"au-cost-template",props:{data:{type:Object},search:{type:String,default:""},status:{type:String,default:""}},methods:{highLight:function(e){if(!e)return"暂无说明";e=e.toString();var t=new RegExp(this.search,"g");return e.replace(t,'<span class="highlightColor">'.concat(this.search,"</span>"))}}}),i=(o("d7ca"),o("2877")),r=Object(i.a)(c,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"au-template",on:{click:function(t){return e.$emit("click")}}},[o("div",{staticClass:"template-center"},[o("div",{staticClass:"text-title",domProps:{innerHTML:e._s(e.highLight(e.data.info.name))}}),o("div",{staticClass:"text-sub-title",domProps:{innerHTML:e._s(e.highLight(e.data.info.des))}})]),o("div",{staticClass:"template-right"},[o("div",{staticClass:"manual-submit"},[e._v(e._s(e.data.info.typeName))]),o("div",{staticClass:"dollar"},[o("div",[e._v("￥")]),o("div",{staticClass:"cost-price"},[e._v(e._s(e.data.info.amount))])])])])},[],!1,null,"41653a73",null).exports,l={ds:[{id:"hmap_exp_pool",queryUrl:"/app/expense-pool/poolListQuery",deleteUrl:"/app/expense-pool/appExpPoolDel",autoCreate:!1,autoQuery:!0}],mixins:[o("d97e").a],created:(a=Object(n.a)(regeneratorRuntime.mark(function e(){var t,o,s,a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$post({url:"/app/expense-pool/appExpPoolTypeQuery",para:{page:1,zSize:10}});case 2:for(t=e.sent,o=t.rows,s=0;s<o.length;s++)this.poolTypes.push({text:o[s].description,value:o[s].moExpPoolTypeId});return o=null,e.next=9,this.$post({url:"/app/code/EXPENSE_POOL_SOURCE_TYPE/",para:{page:1,zSize:10}});case 9:for(a=e.sent,o=a.rows,n=0;n<o.length;n++)this.sourceTypes.push({text:o[n].description,value:o[n].value});case 13:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),data:function(){return{hasHeader:!0,patchFlag:!0,fuzzy_query:"",todoFlag:!0,hasFooter:!0,showCheck:!1,bottomSize:50,allSelected:!1,checked:!1,canSelectAll:!1,scroll:{},bindTarget:"hmap_exp_pool",buttons:[{class:"button-agree",text:"一键报销",callback:this.reimburse}],options:{pullDownRefresh:{threshold:60,stop:40,txt:"更新成功"},pullUpLoad:{threshold:60,txt:"已加载"}},btns:[{action:"delete",text:"删除",color:"#ff3a32"}],autoShrink:!0,sourceType:"请选择",sourceVal:"",poolType:"请选择",poolVal:"",addDatas:[{pic:o("3c9d"),text:this.$t("EX_BI_LIST.NEWINVOICE")},{pic:o("b3c8"),text:this.$t("EX_BI_LIST.NEWEXPENSELIST")}],sourceTypes:[],poolTypes:[],ds:this.$getDs("hmap_exp_pool")}},computed:{},methods:{showAddMenu:function(){var e=this,t=this.$createPopupFromBottom({alldata:this.addDatas,onConfirm:function(o){var s=o.text.substr(o.text.indexOf(".")+1);t.remove(),"New Invoice"==s||"新增发票导入"==s?e.showPopFormBottom():"New Expense List"!=s&&"新增账本信息"!=s||e.$router.push({name:"expense_bill_operator"})}}).show()},pickerSourceType:function(){this.sourcePicker||(this.sourcePicker=this.$createPicker({title:"来源类型",data:[this.sourceTypes],onSelect:this.selectSource,onCancel:function(){}})),this.sourcePicker.show()},pickerPoolType:function(){this.poolPicker||(this.poolPicker=this.$createPicker({title:"费用池类型",data:[this.poolTypes],onSelect:this.selectPool,onCancel:function(){}})),this.poolPicker.show()},selectSource:function(e,t,o){this.sourceVal=this.sourceTypes[t].value,this.sourceType=this.sourceTypes[t].text},selectPool:function(e,t,o){this.poolType=this.poolTypes[t].text,this.poolVal=this.poolTypes[t].value},reimburse:function(){this.canSelectAll=!0,this.showCheck=!0,this.buttons=[{class:"button-cancel",text:"取消",callback:this.cancel},{class:"button-agree",text:"一键报销",callback:this.submit}]},submit:(s=Object(n.a)(regeneratorRuntime.mark(function e(){var t,o,s,a,n,c,i,r,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.ds.getRecordSelected(),o=[],s=!0,a=!1,n=void 0,e.prev=6,c=t[Symbol.iterator]();!(s=(i=c.next()).done);s=!0)r=i.value,l={poolId:r.poolId,currencyCode:r.currencyCode,currencyName:r.currencyName,paymentCurrencySymbol:r.paymentCurrencySymbol,amount:r.amount,companyAmount:r.companyAmount,description:"",moExpPoolTypeId:r.moExpPoolTypeId,moExpPoolTypeName:r.moExpPoolTypeName,sourceType:r.sourceType,sourceTypeName:r.sourceTypeName,expenseDate:r.expenseDate,expenseProperties:r.expenseProperties,busRefId:r.busRefId,businessTypeCode:r.businessTypeCode,businessTypeName:r.businessTypeName,relationModeCodeL:r.relationModeCode,employeeId:r.employeeId,accEntityId:r.accEntityId,icon:"http://hec.hand-china.com:9090/hssp4dev/images/4.0/documents/Private Car Allowance.png",reimbursementFlag:!0,status:"insert"},o.push(l);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),a=!0,n=e.t0;case 14:e.prev=14,e.prev=15,s||null==c.return||c.return();case 17:if(e.prev=17,!a){e.next=20;break}throw n;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.next=24,this.$post({url:"/app/expense-pool/autoCreateReport",para:{lines:o}});case 24:u=e.sent,(r=u.rows[0]).success?this.$createDialog({content:"执行成功，".concat(r.message)}).show():this.$createDialog({content:"执行失败，".concat(r.message)}).show(),this.canSelectAll=!1,this.showCheck=!1,this.buttons=[{class:"button-agree",text:"一键报销",callback:this.reimburse}];case 30:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21]])})),function(){return s.apply(this,arguments)}),cancel:function(){this.ds.unselectAll(),this.allSelected=!1,this.canSelectAll=!1,this.showCheck=!1,this.buttons=[{class:"button-agree",text:"一键报销",callback:this.reimburse}]},agree:function(){var e=this;this.$createDialogDs({type:"prompt",title:"同意",id:"actionDs",onConfirm:function(){var t=e.$getDs("actionDs"),o={comment_text:t.getCurrentRecord().get("comment_text"),_status:"update",action:"1"},s=e.ds.getRecordSelected(o);t.submit({para:s}).then(function(t){e.batchApprove(),e.$refs.view.query()},function(e){})},onCancel:function(){}}).show()},refuse:function(){},selected:function(e,t){this.todoFlag=!0,this.bindTarget=t.bindTarget},selectAll:function(){this.allSelected=!this.allSelected,this.allSelected?this.ds.selectAll():this.ds.unselectAll()},batchApprove:function(){var e=this;this.$createElement,this.$createDialog({title:"",type:"confirm",showClose:!0,confirmBtn:{text:"确定",active:!0},cancelBtn:{text:"重置",active:!1},onConfirm:function(t){e.ds.setParameters({sourceType:e.sourceVal,moExpPoolTypeId:e.poolVal}),e.$refs.view.query()},onCancel:function(){e.sourceVal="",e.sourceType="请选择",e.poolVal="",e.poolType="请选择"}},function(t){return[t("div",{class:{"cube-dialog-title-def":!0},slot:"title"}),t("div",{slot:"content"},[t("div",{class:"popup-body",style:"margin-bottom: -44px;font-size: 0.38rem;line-height: 1.2rem;margin-top: 0.7rem;"},[t("div",{class:"row border-bottom-1px"},[t("div",{class:"col col-30 col-left-title"},[t("span",["来源类型"])," "]),t("div",{class:"col col-60 text-align-right col-right-content"},[t("div",{on:{click:e.pickerSourceType}},[e.sourceType])," "]),t("div",{class:"col col-10 text-align-left"},[t("i",{class:"cubeic-arrow"})," "])]),t("div",{class:"row"},[t("div",{class:"col col-50 col-left-title"},[t("span",["费用池类型"])," "]),t("div",{class:"col col-40 text-align-right col-right-content"},[t("div",{on:{click:e.pickerPoolType}},[e.poolType])," "]),t("div",{class:"col col-10 text-align-left"},[t("i",{class:"cubeic-arrow"})," "])])])])]}).show()},goBillDetail:function(e){this.$router.push({name:"expense_bill_operator",query:{pool_id:e.get("poolId")+""}})},onSwipeBtnClick:function(e,t){var o=this;this.$createDialog({title:"温馨提示",type:"confirm",showClose:!0,confirmBtn:{text:"确定",active:!0},cancelBtn:{text:"取消",active:!1},onConfirm:function(){var e=Object.create(null),s=o.ds;e.header=new Array;var a=s.getRecordFromIndex(t);e.poolId=a.get("poolId"),o.ds.delete(e).then(function(e){s.deleteRecordIndex(t)},function(e){})},onCancel:function(){}},function(e){return[e("div",{class:"delete-prompt",style:{width:"100%",height:"100%",marginBottom:"-20px",marginTop:"32px",textAlign:"center"},slot:"content"},"确定删除该账本？")]}).show()},add:function(){this.$refs.myPopup4.show()},getStatusClass:function(e){return e.get("ins_doc_status")},getTemplateData:function(e){return{info:{name:e.get("moExpPoolTypeName"),des:e.get("businessTypeName"),amount:e.get("amount"),typeName:e.get("sourceTypeName"),icon:"http://hzero-test-80.natapp1.cc:48080/hssp"+e.get("icon")}}}},components:{auCostTemplate:r}},u=(o("a5ae"),Object(i.a)(l,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("au-view",{ref:"view",staticClass:"view-container",attrs:{hasHeader:e.hasHeader,bottomSize:e.bottomSize,hasFooter:e.hasFooter,options:e.options,bindTarget:e.bindTarget,fuzzy_query:e.fuzzy_query,queryKey:"description"}},[o("div",{attrs:{slot:"center"},slot:"center"},[e._v("费用账本")]),o("div",{attrs:{slot:"right"},slot:"right"},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.todoFlag,expression:"todoFlag"}],on:{click:e.batchApprove}},[e._v("\n        "+e._s(e.patchFlag?"筛选":"取消")+"\n      ")])]),o("div",{attrs:{slot:"noScroll"},slot:"noScroll"},[o("au-search",{attrs:{placeholder:"搜索"},model:{value:e.fuzzy_query,callback:function(t){e.fuzzy_query=t},expression:"fuzzy_query"}})],1),o("au-swipe",[o("au-data-scope",{attrs:{bindTarget:e.bindTarget}},[o("au-rows",{scopedSlots:e._u([{key:"default",fn:function(t){return[o("au-checkbox-item",{attrs:{isShow:e.showCheck,record:t.record}},[o("au-swipe-item",{ref:"swipeItem",attrs:{btns:e.btns,index:t.index,autoShrink:e.autoShrink},on:{"btn-click":e.onSwipeBtnClick}},[o("au-cost-template",{attrs:{data:e.getTemplateData(t.record),record:t.record,search:e.fuzzy_query,status:e.getStatusClass(t.record)},on:{click:function(o){return e.goBillDetail(t.record)}}})],1)],1)]}}])})],1)],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("div",{staticClass:"select-container"},[o("au-footer-bar",{attrs:{buttons:e.buttons}},[e.canSelectAll?o("i",{staticClass:"select-all-icon iconfont",class:{"hec-icon-batch-approval-selected":e.allSelected,"hec-icon-batch-approval-unselected":!e.allSelected},on:{click:e.selectAll}}):e._e(),e.canSelectAll?o("div",{staticClass:"select-all-desc"},[e._v("全选")]):e._e()])],1)])],1),o("i",{staticClass:"cubeic-add icon-position",on:{click:e.showAddMenu}}),o("au-popup-from-bottom",{ref:"popFromBottom",attrs:{maskClosable:!0,type:"menus",position:"bottom",mask:!0,alldata:e.alldata}})],1)},[],!1,null,"0b8e2db7",null));t.default=u.exports}}]);