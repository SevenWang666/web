(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bce8a19"],{"0e23":function(e,t,n){"use strict";var i=n("bac3"),o=n.n(i);o.a},"19c7":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("au-view",{staticClass:"view-container background-bills",attrs:{others:e.others,hasFooter:e.hasFooter}},[n("div",{attrs:{slot:"center"},slot:"center"},[e._v("费用详情")]),n("div",{staticClass:"content-container common-margin-size"},[n("div",{staticClass:"line-title vertical-center"},[e._v("头信息")]),n("collapse",e._l(e.fields,function(t,i){return n("div",{key:i,staticClass:"au-item-style paddinig-lr-15 border-none "},[n("div",{staticClass:"col col-30 gray-color"},[e._v(e._s(t.prompt))]),n("div",{staticClass:"col col-70 color-666 text-align-right"},[e._v("\n            "+e._s(e.headInfo[t.key])+"\n          ")])])}),0),n("au-common",{attrs:{id:"lineDetailDs"},on:{select:e.select,cancel:e.cancel,confirm:e.confirm,blur:e.blur,change:e.change,input:e.input}}),n("div",{staticClass:"height-20"})],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("au-footer-bar",{attrs:{buttons:e.buttons}})],1)])],1)},o=[],s=(n("c5f6"),n("7f7f"),{id:"lineDetailDs",queryUrl:"/app/exp/requisition-line/lineDetailQuery",submitUrl:"/app/exp/requisition-line/saveLines",autoCreate:!1,autoQuery:!1}),a=n("36f1"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"slide-up-down"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isVisible,expression:"isVisible"}],staticClass:"expkeyboard"},[n("au-view",{ref:"view",attrs:{others:e.others,bottomSize:e.bottomSize}},[n("div",{attrs:{slot:"center"},slot:"center"},[e._v("费用类型选择")]),n("div",{attrs:{slot:"left"},slot:"left"}),n("div",{ref:"expContent",staticClass:"ion-content"},e._l(e.data,function(t,i){return n("div",{key:i,staticClass:"pos-item"},[n("div",{staticClass:"parent-desc"},[e._v(e._s(t.description))]),e._l(t.items,function(i,o){return n("div",{key:o,ref:"childItem",refInFor:!0},[n("div",{staticClass:"col exp-style"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectId,expression:"selectId"}],staticClass:"radio-style",attrs:{type:"radio"},domProps:{value:i.moExpenseItemId,checked:e._q(e.selectId,i.moExpenseItemId)},on:{click:function(n){return e.selectChild(t,i,n)},change:function(t){e.selectId=i.moExpenseItemId}}}),n("div",{staticClass:"radio-content"},[n("span",[e._v(e._s(i.description))]),n("au-svg-icon",{staticClass:"dot-border icon-pos radio-icon",attrs:{svgName:"selected"}})],1)])])})],2)}),0)]),n("keyboard",{ref:"keyboard",on:{confirm:e.getResult,cancel:e.cancel}},[n("div",{staticClass:"row currency-desc",staticStyle:{background:"#65799B",color:"white"}},[n("div",{staticClass:"col col-70"},[e._v("\n          "+e._s(e.expType.description)+"-"+e._s(e.expItem.description)+"\n        ")]),n("div",{staticClass:"col col-30 text-align-right",on:{click:e.selectAmount}},[n("span",[e._v("\n            "+e._s(e.currencySelected.currencyCode)+"\n          ")]),n("span",[e._v("("+e._s(e.currencySelected.currencyName)+")")])])])])],1)])},c=[],l=n("6f83"),u=n("39a6"),d=n("5899"),p="confirm",m={mixins:[u["a"],d["a"]],props:{source:{type:Object,default:function(){return{currencyCode:"CNY",currencyName:"人民币"}}},selectItem:{type:String,default:""}},data:function(){return{selectId:this.selectItem,selected:"",keyboard:"",scroll:"",bottomSize:0,firstFlag:!0,currencySource:{},expType:{},expItem:{},currencySelected:this.source.currency,others:{callback:this.callback}}},computed:{data:function(){return this.source.expRows}},methods:{selectChild:function(e,t,n){var i=this.scroll.getScrollPosition(),o=i.y,s=n.target.getBoundingClientRect().bottom,a=window.innerHeight,r=305;if(a-s<r){var c=r-(a-s),l=c+-o;console.log(l),this.scroll.scrollTo.call(this.scroll,0,-l,1e3)}this.expType=JSON.parse(JSON.stringify(e)),this.expType.items=t,this.expItem=t,this.keyboard.show()},selectAmount:function(){var e=this;this.$createActionSheet({title:"请选择币种",data:this.currencySource,onSelect:function(t,n){e.currencySelected=t.source},onCancel:function(){}}).show()},callback:function(){this.hide()},queryAmount:function(){var e=this;console.log("执行"),this.$post({url:"/app/lov/GLD_CURRENCY_LOV",para:{page:1}}).then(function(t){if(t.rows){var n=t.rows;e.currencySource=n.map(function(e){return{content:"".concat(e.currencyCode,"(").concat(e.currencyName,")"),source:e}})}})},cancel:function(){this.scroll.refresh()},getResult:function(e){var t=Object.create(null);t={currency:this.currencySelected,expType:this.expType,amount:e||"0"},this.$emit(p,t),this.hide()}},created:function(){this.queryAmount()},mounted:function(){var e=this;this.keyboard=this.$refs.keyboard,this.scroll=this.$refs.view.scroll,this.$refs.expContent.addEventListener("touchmove",function(t){e.firstFlag&&(e.keyboard.hide(),e.firstFlag=!1)}),this.$refs.expContent.addEventListener("touchend",function(t){e.firstFlag=!0})},components:{Keyboard:l["q"]}},f=m,h=(n("df12"),n("2877")),y=Object(h["a"])(f,r,c,!1,null,"c6be9d0c",null),v=(y.exports,n("ad0f")),g={name:"exp-detail",data:function(){var e=this;return{invoices:{},expRequisitionLineId:"",headInfo:this.$store.getters.headInfo,hasFooter:!0,queryFlag:!1,para:"",paraHead:"",lineDetailDs:{},buttons:[{class:"button-reset",text:"保存",callback:this.save},{class:"button-agree",text:"保存并新建",callback:this.saveAndNew}],fields:[{prompt:"公司",key:"companyName"},{prompt:"部门",key:"unitName"},{prompt:"责任中心",key:"respCenterName"},{prompt:"费用发生日期",key:"reportDate"}],list:[{key:"apple",name:"wang"}],others:{callback:function(){e.back()}},btns:[{action:"delete",text:"删除",color:"#ff3a32"}]}},props:{reportPageElementCode:{type:String,default:""}},computed:{isConfigExp:function(){var e=this.lineDetailDs.getFields(),t=!!e.moExpenseItemName;return t},record:function(){var e=this.lineDetailDs.getCurrentRecord();return e}},activated:function(){this.queryInvoice()},methods:{onBtnClick:function(e,t){var n=this;"delete"===e.action&&this.$createDialog({type:"confirm",content:"确认删除吗？",onConfirm:function(){var e=n.invoices[t];e.documentId=n.headInfo.expRequisitionHeaderId,e.documentLineId=n.expRequisitionLineId,n.$post({url:"/app/invoice/deleteReportMoreInvoice",para:e}).then(function(e){n.invoices.splice(t,1)},function(e){n.$createToast({txt:e,type:"txt"}).show()})}}).show()},back:function(){this.$route.query.expRequisitionLineId||this.$route.query.poolId?(this.$store.commit("setData",{name:"forcedJump",value:"add-general-exp"}),this.$router.push({name:"add-general-exp"})):this.$router.go(-1)},confirm:function(e,t,n){"moReqItemName"===t.name&&(e.set("moReqItemName",n.expType.items.description),e.set("moReqItemId",n.expType.items.moReqItemId),e.set("moExpenseTypeId",n.expType.moExpenseTypeId),e.set("amount",n.amount),e.set("businessPrice",Number(n.amount)),e.set("businessAmount",Number(n.amount)*e.get("primaryQuantity")),e.set("paymentAmount",Number(n.amount)*e.get("primaryQuantity")))},select:function(e,t){if("transportationName"===t.name){var n=t.record,i=n.getField("seatClassName");i.setReadonly(!1),i.set("")}},cancel:function(){console.log("abc"),console.log("cancel arguments:"+arguments.length)},input:function(){console.log("input arguments:"+arguments.length)},blur:function(){console.log("blur arguments:"+arguments.length)},change:function(e,t,n){if("primaryQuantity"===t.name){var i=t.record,o=i.get("businessPrice")?i.get("businessPrice"):1,s=i.get("primaryQuantity")*o;i.set("paymentAmount",s)}},save:function(){var e=this;this.lineDetailDs.submit().then(function(t){e.back()},function(e){console.log(e)})},saveAndNew:function(){var e=this;this.lineDetailDs.submit().then(function(t){var n={expRequisitionHeaderId:e.headInfo.expRequisitionHeaderId};e.$createToast({type:"txt",txt:"保存成功"}).show(),e.lineDetailDs.query(n).then(function(t){var n=e.lineDetailDs.getCurrentRecord();n.addData(e.para)}),e.expRequisitionHeaderId=void 0,e.queryConfigInfo()},function(e){console.log(e)})},queryConfigInfo:function(){var e=this;this.$post({url:"/app/exp/requisition-line/appGetReqLineConfig",para:this.para}).then(function(t){if(t.rows[0]){var n=Object(v["a"])(t.rows[0]);e.lineDetailDs.addFields(n)}},function(e){})}},created:function(){var e=this,t=this.headInfo;this.paraHead={expRequisitionHeaderId:this.headInfo.expRequisitionHeaderId,moExpReqTypeId:t.moExpReqTypeId,expRequisitionLineId:this.$route.query.expRequisitionLineId,reqPageElementCode:this.headInfo.reportPageElementCode},this.para={moExpReqTypeId:t.moExpReqTypeId,companyId:t.companyId,bgtEntityId:t.bgtEntityId,accEntityId:t.accEntityId,reqPageElementCode:this.headInfo.reportPageElementCode,pageElementCode:this.headInfo.reportPageElementCode,expRequisitionHeaderId:this.headInfo.expRequisitionHeaderId,employeeId:t.employeeId,paymentCurrencyCode:t.paymentCurrencyCode},this.lineDetailDs=this.$createDs(s,this),this.expRequisitionLineId=this.$route.query.expRequisitionLineId,this.lineDetailDs.query(this.paraHead).then(function(t){var n=e.lineDetailDs.getCurrentRecord();n.addData(e.para),n.set("expRequisitionDistId",e.paraHead.expRequisitionDistId)}),this.queryConfigInfo(),this.headInfo.reportPageElementCode},components:{collapse:a["a"]}},b=g,I=(n("0e23"),Object(h["a"])(b,i,o,!1,null,"1878fef6",null));t["default"]=I.exports},"36f1":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("au-collapse",{attrs:{isReverse:"",collapseStyle:{backgroundColor:"transparent"}}},[n("div",{staticClass:"show-more background-bills",attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"vertical-center justify-content-center padding-tb-10",on:{click:e.toggle}},[n("span",{staticClass:"col gray-line"}),n("span",{staticClass:"font-common color-gray"},[e._v("\n          "+e._s(e.showFlag?"收起":"展开")+"\n        ")]),n("span",{staticClass:"col gray-line"})])]),n("div",{staticClass:"transition-style",attrs:{slot:"content"},slot:"content"},[e._t("default")],2)])],1)},o=[],s={props:{open:{type:Boolean,default:!1}},data:function(){return{showFlag:this.show}},methods:{toggle:function(){this.showFlag=!this.showFlag}}},a=s,r=(n("5e90"),n("2877")),c=Object(r["a"])(a,i,o,!1,null,"261e739c",null);t["a"]=c.exports},"5e90":function(e,t,n){"use strict";var i=n("b6be"),o=n.n(i);o.a},"9eaf":function(e,t,n){},ad0f:function(e,t,n){"use strict";n.d(t,"a",function(){return o});n("ac6a");var i=n("75fc");function o(e){var t={commonList:[],descList:[]},n={commonList:[],descList:[]},o={commonList:[],descList:[]};if(Array.isArray(e.columns)&&e.columns.length>0){var a=e.columns;t=s(a)}if(Array.isArray(e.dimensions)&&e.dimensions.length>0){var r=e.dimensions;n=s(r)}if(Array.isArray(e.objects)&&e.objects.length>0){var c=e.objects;o=s(c)}if(Array.isArray(e.vatInvoiceConfig)&&e.vatInvoiceConfig.length>0){var l=e.vatInvoiceConfig;t=s(l)}return[].concat(Object(i["a"])(t.commonList),Object(i["a"])(n.commonList),Object(i["a"])(o.commonList),Object(i["a"])(t.descList),Object(i["a"])(n.descList),Object(i["a"])(o.descList))}function s(e){var t={commonList:[],descList:[]};return e.forEach(function(e){var n=e.lovConfig,i={name:e.column,key:e.keyField,prompt:e.prompt,placeholder:e.placeholder,required:!!e.required,readonly:!!e.readonly,editor_type:e.editor,length:"",showFlag:!0,mapping:Array.isArray(e.mapping)?e.mapping:[e.mapping],queryDs:e.codeConfig?e.codeConfig.queryDs:"",display_field:e.codeConfig?e.codeConfig.displayField:"",lovConfig:n?{queryUrl:n.lovCode?"/app/lov/".concat(n.lovCode):e.queryUrl,autoCreate:!1,para:a(n.values),paraFromDs:n.parameters,autoQuery:!1}:"",others:e.lovConfig?Object.assign({},e.lovConfig.others,{queryUrl:e.queryUrl}):""};"Textarea"!=i.editor_type?t.commonList.push(i):"Textarea"===i.editor_type&&t.descList.push(i)}),t}function a(e){if(e){var t=Object.create(null);return Array.isArray(e)&&e.forEach(function(e){Object.assign(t,e)}),t}}},b6be:function(e,t,n){},bac3:function(e,t,n){},df12:function(e,t,n){"use strict";var i=n("9eaf"),o=n.n(i);o.a}}]);