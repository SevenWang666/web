(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e749e48c"],{"0456":function(t,e,a){},"6d06":function(t,e,a){"use strict";var n=a("0456");a.n(n).a},d0c7:function(t,e,a){"use strict";a.r(e),a("8e6e"),a("456d");var n=a("bd86");function r(t,e){var a=Object.keys(t);return Object.getOwnPropertySymbols&&a.push.apply(a,Object.getOwnPropertySymbols(t)),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a}a("ac6a");var o={data:function(){var t=this;return{files:[],hasFooter:!0,images:[],initialIndex:0,headInfo:this.$store.getters.headInfo,action:{target:"".concat("http://hzero-test-80.natapp1.cc:48080/hssp","/app/fnd/atm-attachment/upload?_csrf=").concat(window.sessionStorage.getItem("token"),"&tableName=EXP_REPORT_HEADER&tablePkValue=").concat(this.$store.getters.headInfo.expReportHeaderId),timeout:1500,prop:"base64Value",withCredentials:!0,data:function(e){return{tablePkValue:t.$store.getters.headInfo.expReportHeaderId,source_type:"EXP_REPORT_HEADER",fileToUpload:e.file}},progressInterval:200,headers:function(t){var e=window.sessionStorage.getItem("token"),a={};if(e){var n=window.localStorage.getItem("userName")+":"+window.localStorage.getItem("password"),r=window.btoa(window.encodeURI(n));a.Authorization="Basic ".concat(r),a["X-CSRF-TOKEN"]=e}return a}},buttons:[{class:"button-reset",text:"上一步",callback:this.back},{class:"button-agree",text:"完成创建/修改",callback:this.nextStep}]}},methods:{back:function(){this.$router.back()},retry:function(t){this.$refs.upload.retry(t)},nextStep:function(){this.$store.commit("setData",{name:"forcedJump",value:"apply-recheck"}),this.$router.push({path:"/apply-recheck",query:{headId:this.headInfo.expReportHeaderId}})},preview:function(t){var e=this;this.initialIndex=t;var a=[];this.images.forEach(function(t){a.push(t.url)});var o={$props:{imgs:a,initialIndex:"initialIndex",loop:!0},$events:{change:function(t){e.initialIndex=t}}};this.$createImagePreview(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(a,!0).forEach(function(e){Object(n.a)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},o)).show()},deleteImg:function(t,e){var a=this;this.$post({url:"/app/fnd/atm-attachment/remove",para:{attachmentId:t.attachmentId}}).then(function(t){a.images.splice(e,1)},function(t){})},fileSuccess:function(){this.getAttachment()},getAttachment:function(){var t=this,e={tableName:"EXP_REPORT_HEADER",tablePkValue:this.headInfo.expReportHeaderId};this.$post({url:"/app/fnd/atm-attachment/query",para:e}).then(function(e){e.rows&&(t.images=e.rows.map(function(t){return{url:"".concat("http://hzero-test-80.natapp1.cc:48080/hssp","/fnd/atm-attachment/preview?attachmentId=").concat(t.attachmentId),attachmentId:t.attachmentId}}),t.files.length>0&&t.files.splice(0,1))},function(t){})}},created:function(){this.getAttachment()}},s=(a("6d06"),a("2877")),i=Object(s.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("au-view",{staticClass:"view-container background-bills",attrs:{hasFooter:t.hasFooter}},[a("div",{attrs:{slot:"center"},slot:"center"},[t._v("添加附件")]),a("div",{staticClass:"content-container"},[a("div",{staticClass:"upload-style"},[a("au-upload",{ref:"upload",attrs:{action:t.action,"simultaneous-uploads":1},on:{"file-success":t.fileSuccess},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[t._l(t.images,function(e,n){return a("div",{key:e.url,staticClass:"img-style"},[a("img",{attrs:{src:e.url,width:"80",height:"80"},on:{click:function(e){return t.preview(n)}}}),a("div",{staticClass:"wrong-pos",on:{click:function(a){return t.deleteImg(e,n)}}},[a("i",{staticClass:"cubeic-wrong"})])])}),t._l(t.files,function(e,n){return a("au-upload-file",{key:n,staticClass:"img-style",attrs:{file:e},on:{click:function(a){return t.retry(e)}}})}),a("au-upload-btn",{staticClass:"img-style"})],2)],1)]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("au-footer-bar",{attrs:{buttons:t.buttons}})],1)])},[],!1,null,"4aea3545",null);e.default=i.exports}}]);