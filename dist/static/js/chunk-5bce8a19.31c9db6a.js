(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5bce8a19"],{"0e23":function(e,t,i){"use strict";var n=i("bac3");i.n(n).a},"19c7":function(e,t,i){"use strict";i.r(t),i("c5f6"),i("7f7f");var n={id:"lineDetailDs",queryUrl:"/app/exp/requisition-line/lineDetailQuery",submitUrl:"/app/exp/requisition-line/saveLines",autoCreate:!1,autoQuery:!1},s=i("36f1"),o=i("6f83"),a=i("39a6"),r=i("5899"),c={mixins:[a.a,r.a],props:{source:{type:Object,default:function(){return{currencyCode:"CNY",currencyName:"人民币"}}},selectItem:{type:String,default:""}},data:function(){return{selectId:this.selectItem,selected:"",keyboard:"",scroll:"",bottomSize:0,firstFlag:!0,currencySource:{},expType:{},expItem:{},currencySelected:this.source.currency,others:{callback:this.callback}}},computed:{data:function(){return this.source.expRows}},methods:{selectChild:function(e,t,i){var n=this.scroll.getScrollPosition().y,s=i.target.getBoundingClientRect().bottom,o=window.innerHeight;if(o-s<305){var a=305-(o-s)-n;this.scroll.scrollTo.call(this.scroll,0,-a,1e3)}this.expType=JSON.parse(JSON.stringify(e)),this.expType.items=t,this.expItem=t,this.keyboard.show()},selectAmount:function(){var e=this;this.$createActionSheet({title:"请选择币种",data:this.currencySource,onSelect:function(t,i){e.currencySelected=t.source},onCancel:function(){}}).show()},callback:function(){this.hide()},queryAmount:function(){var e=this;this.$post({url:"/app/lov/GLD_CURRENCY_LOV",para:{page:1}}).then(function(t){if(t.rows){var i=t.rows;e.currencySource=i.map(function(e){return{content:"".concat(e.currencyCode,"(").concat(e.currencyName,")"),source:e}})}})},cancel:function(){this.scroll.refresh()},getResult:function(e){var t=Object.create(null);t={currency:this.currencySelected,expType:this.expType,amount:e||"0"},this.$emit("confirm",t),this.hide()}},created:function(){this.queryAmount()},mounted:function(){var e=this;this.keyboard=this.$refs.keyboard,this.scroll=this.$refs.view.scroll,this.$refs.expContent.addEventListener("touchmove",function(t){e.firstFlag&&(e.keyboard.hide(),e.firstFlag=!1)}),this.$refs.expContent.addEventListener("touchend",function(t){e.firstFlag=!0})},components:{Keyboard:o.q}},l=(i("df12"),i("2877")),u=(Object(l.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"slide-up-down"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isVisible,expression:"isVisible"}],staticClass:"expkeyboard"},[i("au-view",{ref:"view",attrs:{others:e.others,bottomSize:e.bottomSize}},[i("div",{attrs:{slot:"center"},slot:"center"},[e._v("费用类型选择")]),i("div",{attrs:{slot:"left"},slot:"left"}),i("div",{ref:"expContent",staticClass:"ion-content"},e._l(e.data,function(t,n){return i("div",{key:n,staticClass:"pos-item"},[i("div",{staticClass:"parent-desc"},[e._v(e._s(t.description))]),e._l(t.items,function(n,s){return i("div",{key:s,ref:"childItem",refInFor:!0},[i("div",{staticClass:"col exp-style"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.selectId,expression:"selectId"}],staticClass:"radio-style",attrs:{type:"radio"},domProps:{value:n.moExpenseItemId,checked:e._q(e.selectId,n.moExpenseItemId)},on:{click:function(i){return e.selectChild(t,n,i)},change:function(t){e.selectId=n.moExpenseItemId}}}),i("div",{staticClass:"radio-content"},[i("span",[e._v(e._s(n.description))]),i("au-svg-icon",{staticClass:"dot-border icon-pos radio-icon",attrs:{svgName:"selected"}})],1)])])})],2)}),0)]),i("keyboard",{ref:"keyboard",on:{confirm:e.getResult,cancel:e.cancel}},[i("div",{staticClass:"row currency-desc",staticStyle:{background:"#65799B",color:"white"}},[i("div",{staticClass:"col col-70"},[e._v("\n          "+e._s(e.expType.description)+"-"+e._s(e.expItem.description)+"\n        ")]),i("div",{staticClass:"col col-30 text-align-right",on:{click:e.selectAmount}},[i("span",[e._v("\n            "+e._s(e.currencySelected.currencyCode)+"\n          ")]),i("span",[e._v("("+e._s(e.currencySelected.currencyName)+")")])])])])],1)])},[],!1,null,"c6be9d0c",null).exports,i("ad0f")),d={name:"exp-detail",data:function(){var e=this;return{invoices:{},expRequisitionLineId:"",headInfo:this.$store.getters.headInfo,hasFooter:!0,queryFlag:!1,para:"",paraHead:"",lineDetailDs:{},buttons:[{class:"button-reset",text:"保存",callback:this.save},{class:"button-agree",text:"保存并新建",callback:this.saveAndNew}],fields:[{prompt:"公司",key:"companyName"},{prompt:"部门",key:"unitName"},{prompt:"责任中心",key:"respCenterName"},{prompt:"费用发生日期",key:"reportDate"}],list:[{key:"apple",name:"wang"}],others:{callback:function(){e.back()}},btns:[{action:"delete",text:"删除",color:"#ff3a32"}]}},props:{reportPageElementCode:{type:String,default:""}},computed:{isConfigExp:function(){return!!this.lineDetailDs.getFields().moExpenseItemName},record:function(){var e=this.lineDetailDs.getCurrentRecord();return e}},activated:function(){this.queryInvoice()},methods:{onBtnClick:function(e,t){var i=this;"delete"===e.action&&this.$createDialog({type:"confirm",content:"确认删除吗？",onConfirm:function(){var e=i.invoices[t];e.documentId=i.headInfo.expRequisitionHeaderId,e.documentLineId=i.expRequisitionLineId,i.$post({url:"/app/invoice/deleteReportMoreInvoice",para:e}).then(function(e){i.invoices.splice(t,1)},function(e){i.$createToast({txt:e,type:"txt"}).show()})}}).show()},back:function(){this.$route.query.expRequisitionLineId||this.$route.query.poolId?(this.$store.commit("setData",{name:"forcedJump",value:"add-general-exp"}),this.$router.push({name:"add-general-exp"})):this.$router.go(-1)},confirm:function(e,t,i){"moReqItemName"===t.name&&(e.set("moReqItemName",i.expType.items.description),e.set("moReqItemId",i.expType.items.moReqItemId),e.set("moExpenseTypeId",i.expType.moExpenseTypeId),e.set("amount",i.amount),e.set("businessPrice",Number(i.amount)),e.set("businessAmount",Number(i.amount)*e.get("primaryQuantity")),e.set("paymentAmount",Number(i.amount)*e.get("primaryQuantity")))},select:function(e,t){if("transportationName"===t.name){var i=t.record.getField("seatClassName");i.setReadonly(!1),i.set("")}},cancel:function(){},input:function(){},blur:function(){},change:function(e,t,i){if("primaryQuantity"===t.name){var n=t.record,s=n.get("businessPrice")?n.get("businessPrice"):1,o=n.get("primaryQuantity")*s;n.set("paymentAmount",o)}},save:function(){var e=this;this.lineDetailDs.submit().then(function(t){e.back()},function(e){})},saveAndNew:function(){var e=this;this.lineDetailDs.submit().then(function(t){var i={expRequisitionHeaderId:e.headInfo.expRequisitionHeaderId};e.$createToast({type:"txt",txt:"保存成功"}).show(),e.lineDetailDs.query(i).then(function(t){e.lineDetailDs.getCurrentRecord().addData(e.para)}),e.expRequisitionHeaderId=void 0,e.queryConfigInfo()},function(e){})},queryConfigInfo:function(){var e=this;this.$post({url:"/app/exp/requisition-line/appGetReqLineConfig",para:this.para}).then(function(t){if(t.rows[0]){var i=Object(u.a)(t.rows[0]);e.lineDetailDs.addFields(i)}},function(e){})}},created:function(){var e=this,t=this.headInfo;this.paraHead={expRequisitionHeaderId:this.headInfo.expRequisitionHeaderId,moExpReqTypeId:t.moExpReqTypeId,expRequisitionLineId:this.$route.query.expRequisitionLineId,reqPageElementCode:this.headInfo.reportPageElementCode},this.para={moExpReqTypeId:t.moExpReqTypeId,companyId:t.companyId,bgtEntityId:t.bgtEntityId,accEntityId:t.accEntityId,reqPageElementCode:this.headInfo.reportPageElementCode,pageElementCode:this.headInfo.reportPageElementCode,expRequisitionHeaderId:this.headInfo.expRequisitionHeaderId,employeeId:t.employeeId,paymentCurrencyCode:t.paymentCurrencyCode},this.lineDetailDs=this.$createDs(n,this),this.expRequisitionLineId=this.$route.query.expRequisitionLineId,this.lineDetailDs.query(this.paraHead).then(function(t){var i=e.lineDetailDs.getCurrentRecord();i.addData(e.para),i.set("expRequisitionDistId",e.paraHead.expRequisitionDistId)}),this.queryConfigInfo(),this.headInfo.reportPageElementCode},components:{collapse:s.a}},p=(i("0e23"),Object(l.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("au-view",{staticClass:"view-container background-bills",attrs:{others:e.others,hasFooter:e.hasFooter}},[i("div",{attrs:{slot:"center"},slot:"center"},[e._v("费用详情")]),i("div",{staticClass:"content-container common-margin-size"},[i("div",{staticClass:"line-title vertical-center"},[e._v("头信息")]),i("collapse",e._l(e.fields,function(t,n){return i("div",{key:n,staticClass:"au-item-style paddinig-lr-15 border-none "},[i("div",{staticClass:"col col-30 gray-color"},[e._v(e._s(t.prompt))]),i("div",{staticClass:"col col-70 color-666 text-align-right"},[e._v("\n            "+e._s(e.headInfo[t.key])+"\n          ")])])}),0),i("au-common",{attrs:{id:"lineDetailDs"},on:{select:e.select,cancel:e.cancel,confirm:e.confirm,blur:e.blur,change:e.change,input:e.input}}),i("div",{staticClass:"height-20"})],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("au-footer-bar",{attrs:{buttons:e.buttons}})],1)])],1)},[],!1,null,"1878fef6",null));t.default=p.exports},"36f1":function(e,t,i){"use strict";var n={props:{open:{type:Boolean,default:!1}},data:function(){return{showFlag:this.show}},methods:{toggle:function(){this.showFlag=!this.showFlag}}},s=(i("5e90"),i("2877")),o=Object(s.a)(n,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("au-collapse",{attrs:{isReverse:"",collapseStyle:{backgroundColor:"transparent"}}},[t("div",{staticClass:"show-more background-bills",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"vertical-center justify-content-center padding-tb-10",on:{click:this.toggle}},[t("span",{staticClass:"col gray-line"}),t("span",{staticClass:"font-common color-gray"},[this._v("\n          "+this._s(this.showFlag?"收起":"展开")+"\n        ")]),t("span",{staticClass:"col gray-line"})])]),t("div",{staticClass:"transition-style",attrs:{slot:"content"},slot:"content"},[this._t("default")],2)])],1)},[],!1,null,"261e739c",null);t.a=o.exports},"5e90":function(e,t,i){"use strict";var n=i("b6be");i.n(n).a},"9eaf":function(e,t,i){},ad0f:function(e,t,i){"use strict";i.d(t,"a",function(){return s}),i("ac6a");var n=i("75fc");function s(e){var t={commonList:[],descList:[]},i={commonList:[],descList:[]},s={commonList:[],descList:[]};return Array.isArray(e.columns)&&e.columns.length>0&&(t=o(e.columns)),Array.isArray(e.dimensions)&&e.dimensions.length>0&&(i=o(e.dimensions)),Array.isArray(e.objects)&&e.objects.length>0&&(s=o(e.objects)),Array.isArray(e.vatInvoiceConfig)&&e.vatInvoiceConfig.length>0&&(t=o(e.vatInvoiceConfig)),[].concat(Object(n.a)(t.commonList),Object(n.a)(i.commonList),Object(n.a)(s.commonList),Object(n.a)(t.descList),Object(n.a)(i.descList),Object(n.a)(s.descList))}function o(e){var t={commonList:[],descList:[]};return e.forEach(function(e){var i=e.lovConfig,n={name:e.column,key:e.keyField,prompt:e.prompt,placeholder:e.placeholder,required:!!e.required,readonly:!!e.readonly,editor_type:e.editor,length:"",showFlag:!0,mapping:Array.isArray(e.mapping)?e.mapping:[e.mapping],queryDs:e.codeConfig?e.codeConfig.queryDs:"",display_field:e.codeConfig?e.codeConfig.displayField:"",lovConfig:i?{queryUrl:i.lovCode?"/app/lov/".concat(i.lovCode):e.queryUrl,autoCreate:!1,para:a(i.values),paraFromDs:i.parameters,autoQuery:!1}:"",others:e.lovConfig?Object.assign({},e.lovConfig.others,{queryUrl:e.queryUrl}):""};"Textarea"!=n.editor_type?t.commonList.push(n):"Textarea"===n.editor_type&&t.descList.push(n)}),t}function a(e){if(e){var t=Object.create(null);return Array.isArray(e)&&e.forEach(function(e){Object.assign(t,e)}),t}}},b6be:function(e,t,i){},bac3:function(e,t,i){},df12:function(e,t,i){"use strict";var n=i("9eaf");i.n(n).a}}]);