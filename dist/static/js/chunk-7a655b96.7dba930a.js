(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7a655b96"],{"53ce":function(t,e,n){"use strict";n.r(e),n("8e6e"),n("456d");var a=n("bd86");function i(t,e){var n=Object.keys(t);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(t)),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n}n("ac6a"),n("c5f6");var o={props:{certificationId:{type:Number,default:function(){return 0}}},data:function(){var t=this;return{files:[],hasFooter:!0,images:[],initialIndex:0,action:{target:"".concat("http://hzero-80.natapp1.cc:58080/hssp-zhongyu","/app/fnd/atm-attachment/upload?_csrf=").concat(window.sessionStorage.getItem("token"),"&tableName=INVOICE_REPORT_HEADER&tablePkValue=").concat(this.certificationId),timeout:1500,prop:"base64Value",withCredentials:!0,data:function(e){return{tablePkValue:t.certificationId,source_type:"INVOICE_REPORT_HEADER",fileToUpload:e.file}},progressInterval:200,headers:function(t){var e=window.sessionStorage.getItem("token"),n={};if(e){var a=window.localStorage.getItem("userName")+":"+window.localStorage.getItem("password"),i=window.btoa(window.encodeURI(a));n.Authorization="Basic ".concat(i),n["X-CSRF-TOKEN"]=e}return n}},buttons:[{class:"button-agree",text:"上传至发票池",callback:this.nextStep}]}},methods:{back:function(){this.$router.back()},retry:function(t){this.$refs.upload.retry(t)},nextStep:function(){this.$router.push({name:"invoice-detail",params:{certificationId:this.certificationId,invoiceId:this.invoiceId}}),sessionStorage.setItem("newInvioce","1")},preview:function(t){var e=this;this.initialIndex=t;var n=[];this.images.forEach(function(t){n.push(t.url)});var o={$props:{imgs:n,initialIndex:"initialIndex",loop:!0},$events:{change:function(t){e.initialIndex=t}}};this.$createImagePreview(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(n,!0).forEach(function(e){Object(a.a)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},o)).show()},deleteImg:function(t,e){var n=this;this.$post({url:"/app/fnd/atm-attachment/remove",para:{attachmentId:t.attachmentId}}).then(function(t){n.images.splice(e,1)},function(t){})},fileSuccess:function(){this.getAttachment()},getAttachment:function(){var t=this,e={tableName:"INVOICE_REPORT_HEADER",tablePkValue:this.certificationId};this.$post({url:"/app/fnd/atm-attachment/query",para:e}).then(function(e){e.rows&&(t.images=e.rows.map(function(t){return{url:"".concat("http://hzero-80.natapp1.cc:58080/hssp-zhongyu","/fnd/atm-attachment/preview?attachmentId=").concat(t.attachmentId),attachmentId:t.attachmentId}}),t.files.length>0&&t.files.splice(0,1))},function(t){})}},created:function(){this.getAttachment()}},r=(n("aa07"),n("2877")),c=Object(r.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("au-view",{staticClass:"view-container background-bills",attrs:{hasFooter:t.hasFooter}},[n("div",{attrs:{slot:"center"},slot:"center"},[t._v("添加附件")]),n("div",{staticClass:"content-container"},[n("div",{staticClass:"upload-style"},[n("au-upload",{ref:"upload",attrs:{action:t.action,"simultaneous-uploads":1},on:{"file-success":t.fileSuccess},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[t._l(t.images,function(e,a){return n("div",{key:e.url,staticClass:"img-style"},[n("img",{attrs:{src:e.url,width:"80",height:"80"},on:{click:function(e){return t.preview(a)}}}),n("div",{staticClass:"wrong-pos",on:{click:function(n){return t.deleteImg(e,a)}}},[n("i",{staticClass:"cubeic-wrong"})])])}),t._l(t.files,function(e,a){return n("au-upload-file",{key:a,staticClass:"img-style",attrs:{file:e},on:{click:function(n){return t.retry(e)}}})}),n("au-upload-btn",{staticClass:"img-style"})],2)],1)]),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("au-footer-bar",{attrs:{buttons:t.buttons}})],1)])},[],!1,null,"1657997e",null);e.default=c.exports},aa07:function(t,e,n){"use strict";var a=n("fa92");n.n(a).a},fa92:function(t,e,n){}}]);