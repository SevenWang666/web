(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-27e470f6"],{"2a91":function(e,t,s){"use strict";s.r(t),s("ac4d"),s("8a81"),s("ac6a"),s("6762"),s("2fdb"),s("96cf");var a,i,r=s("3b8d"),n={created:(i=Object(r.a)(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.$route.query.relationModeCode,t=this.$route.query.moExpPoolTypeId,s=this.$route.query.busRefId,e.next=6,this.$post({url:"/app/expense-pool/expensePoolRefReqLovQuery",para:{moExpPoolTypeId:t,busRefId:s}});case 6:a=e.sent,this.datas=a.rows;case 8:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),data:function(){return{hasHeader:!0,hasFooter:!1,patchFlag:!0,bottomSize:0,fuzzy_query:"",datas:[],allSelected:!1,buttons:[{class:"button-relate",text:this.$t("COMMON.RELATE"),callback:this.relate}],selectIds:[]}},methods:{batchApprove:function(){this.selectIds.length=0,this.allSelected&&(this.allSelected=!1),this.patchFlag=!this.patchFlag,this.patchFlag?(this.bottomSize=0,this.hasFooter=!1):(this.bottomSize=50,this.hasFooter=!0)},clickCard:function(e){if(this.hasFooter){this.allSelected&&(this.allSelected=!1);var t=this.selectIds.indexOf(e);-1==t?this.selectIds.push(e):this.selectIds.splice(t,1),this.selectIds.length==this.datas.length&&(this.allSelected=!0)}else this.selectIds.push(e),this.relate()},checkSelect:function(e){return this.selectIds.includes(e)},selectAll:function(){if(this.allSelected=!this.allSelected,this.selectIds.length=0,this.allSelected){var e=!0,t=!1,s=void 0;try{for(var a,i=this.datas[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var r=a.value.expRequisitionLineId;this.selectIds.push(r)}}catch(e){t=!0,s=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw s}}}},relate:(a=Object(r.a)(regeneratorRuntime.mark(function e(){var t,s,a,i,r,n,c,l,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.$route.query.busRefId+"",s=parseInt(this.$route.query.poolId),a=[],i=!0,r=!1,n=void 0,e.prev=8,c=this.selectIds[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)o=l.value,a.push({poolId:s,status:"add",expRequisitionHeaderId:o+"",refId:t});e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),r=!0,n=e.t0;case 16:e.prev=16,e.prev=17,i||null==c.return||c.return();case 19:if(e.prev=19,!r){e.next=22;break}throw n;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return e.next=27,this.$post({url:"/app/expense-pool/expensePoolRefReqSubmit",para:{lines:a}});case 27:e.sent,this.$router.go(-1);case 30:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23]])})),function(){return a.apply(this,arguments)})}},c=(s("aff3"),s("2877")),l=Object(c.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("au-view",{ref:"view",staticClass:"view-container",attrs:{hasHeader:e.hasHeader,bottomSize:e.bottomSize,hasFooter:e.hasFooter}},[s("div",{attrs:{slot:"center"},slot:"center"},[e._v("关联申请单")]),s("div",{attrs:{slot:"right"},slot:"right"},[s("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.datas.length,expression:"datas.length != 0"}],on:{click:e.batchApprove}},[e._v("\n      "+e._s(e.patchFlag?e.$t("EX_BI_LIST.BATCHRELATE"):e.$t("APP_LIST.CANCEL"))+"\n    ")])]),s("div",{staticClass:"wrapper"},[0==e.datas.length?s("div",{staticClass:"err"},[e._v("\n      数据为空！\n    ")]):e._e(),e._l(e.datas,function(t,a){return s("div",{key:a,staticClass:"out",on:{click:function(s){return e.clickCard(t.expRequisitionLineId)}}},[e.hasFooter?s("div",{staticClass:"cir"},[s("i",{staticClass:"select-all-icon iconfont",class:{"hec-icon-batch-approval-selected":e.checkSelect(t.expRequisitionLineId),"hec-icon-batch-approval-unselected":!e.checkSelect(t.expRequisitionLineId)}})]):e._e(),s("div",{staticClass:"card"},[s("div",{staticClass:"info-1"},[s("div",{staticClass:"invoice-code"},[e._v(e._s(t.expRequisitionNumber))])]),s("div",{staticClass:"type-name"},[e._v(e._s(t.reqMoExpenseTypeName))]),s("div",{staticClass:"info-2"},[s("div",{staticClass:"amount"},[e._v("\n            "+e._s(t.paymentCurrencyCode+" "+t.paymentAmount)+"\n          ")])])])])})],2),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"select-container"},[s("au-footer-bar",{attrs:{buttons:e.buttons}},[s("i",{staticClass:"select-all-icon iconfont",class:{"hec-icon-batch-approval-selected":e.allSelected,"hec-icon-batch-approval-unselected":!e.allSelected},on:{click:e.selectAll}}),s("div",{staticClass:"select-all-desc"},[e._v(e._s(e.$t("COMMON.SELECTALL")))])])],1)])])},[],!1,null,"8e23704e",null);t.default=l.exports},6705:function(e,t,s){},aff3:function(e,t,s){"use strict";var a=s("6705");s.n(a).a}}]);