(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f48268be"],{"753a":function(t,s,i){"use strict";var e=i("7f65"),a=i.n(e);a.a},"7f65":function(t,s,i){},d020:function(t,s,i){"use strict";i.r(s);var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentValue,expression:"currentValue"}],staticClass:"masks"},[i("div",{staticClass:"gesturePwd"},[i("div",{staticClass:"box"},[i("h4",{ref:"gestureTitle",staticClass:"gestureTitle"},[t._v("请绘制您的图形密码")]),i("a",{ref:"updatePassword",staticClass:"reset",on:{click:function(s){return t.updatePassword()}}},[t._v("\n        重置密码\n      ")]),i("a",{ref:"updatePassword",staticClass:"close",on:{click:function(s){return t.closePwd(!1)}}},[t._v("关闭")]),i("canvas",{ref:"canvas"})])])])},a=[],r=(i("c5f6"),i("6c7b"),{props:{value:{type:Boolean,default:!1}},data:function(){return{currentValue:!1,ctx:"",width:0,height:0,devicePixelRatio:0,chooseType:"",r:"",lastPoint:[],arr:[],restPoint:[],pswObj:{step:2},canvas:""}},watch:{value:{handler:function(t){this.currentValue=t},immediate:!0},currentValue:function(t){this.$emit(t?"on-show":"on-hide"),this.$emit("input",t)}},created:function(){"undefined"!==typeof this.value&&(this.currentValue=this.value)},mounted:function(){this.setChooseType(3)},methods:{closePwd:function(t){this.$emit("handPwd",t),this.currentValue=!1},drawCle:function(t,s){this.ctx.strokeStyle="#87888a",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.arc(t,s,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.stroke()},drawPoint:function(t){for(var s=0;s<this.lastPoint.length;s++)this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[s].x,this.lastPoint[s].y,this.r/2.5,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},drawStatusPoint:function(t){for(var s=0;s<this.lastPoint.length;s++)this.ctx.strokeStyle=t,this.ctx.beginPath(),this.ctx.arc(this.lastPoint[s].x,this.lastPoint[s].y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.stroke()},drawLine:function(t,s,i){this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.lineWidth=3,this.ctx.moveTo(this.lastPoint[0].x,this.lastPoint[0].y);for(var e=1;e<this.lastPoint.length;e++)this.ctx.lineTo(this.lastPoint[e].x,this.lastPoint[e].y);this.ctx.lineTo(s.x,s.y),this.ctx.stroke(),this.ctx.closePath()},createCircle:function(){var t=this.chooseType,s=0;this.r=this.ctx.canvas.width/(2+4*t),this.lastPoint=[],this.arr=[],this.restPoint=[];for(var i=this.r,e=0;e<t;e++)for(var a=0;a<t;a++){s++;var r={x:4*a*i+3*i,y:4*e*i+3*i,index:s};this.arr.push(r),this.restPoint.push(r)}this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var n=0;n<this.arr.length;n++)this.drawCle(this.arr[n].x,this.arr[n].y)},getPosition:function(t){var s=t.currentTarget.getBoundingClientRect(),i={x:(t.touches[0].clientX-s.left)*this.devicePixelRatio,y:(t.touches[0].clientY-s.top)*this.devicePixelRatio};return i},update:function(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var s=0;s<this.arr.length;s++)this.drawCle(this.arr[s].x,this.arr[s].y);this.drawPoint("#27AED5"),this.drawStatusPoint("#27AED5"),this.drawLine("#27AED5",t,this.lastPoint);for(var i=0;i<this.restPoint.length;i++)if(Math.abs(t.x-this.restPoint[i].x)<this.r&&Math.abs(t.y-this.restPoint[i].y)<this.r){this.drawPoint(this.restPoint[i].x,this.restPoint[i].y),this.lastPoint.push(this.restPoint[i]),this.restPoint.splice(i,1);break}},checkPass:function(t,s){for(var i="",e="",a=0;a<t.length;a++)i+=t[a].index+t[a].index;for(var r=0;r<s.length;r++)e+=s[r].index+s[r].index;return i===e},storePass:function(t){if(1==this.pswObj.step)this.checkPass(this.pswObj.fpassword,t)?(this.pswObj.step=2,this.pswObj.spassword=t,this.$refs.gestureTitle.innerHTML="密码保存成功",this.drawStatusPoint("#2CFF26"),this.drawPoint("#2CFF26"),window.localStorage.setItem("passwordxx",JSON.stringify(this.pswObj.spassword)),window.localStorage.setItem("chooseType",this.chooseType)):(this.$refs.gestureTitle.innerHTML="两次不一致，重新输入",this.drawStatusPoint("red"),this.drawPoint("red"),delete this.pswObj.step);else if(2==this.pswObj.step)if(this.checkPass(this.pswObj.spassword,t)){var s=this.$refs.gestureTitle;s.style.color="#2CFF26",s.innerHTML="解锁成功",this.drawStatusPoint("#2CFF26"),this.drawPoint("#2CFF26"),this.drawLine("#2CFF26",this.lastPoint[this.lastPoint.length-1],this.lastPoint),this.closePwd(!0)}else if(t.length<4){this.drawStatusPoint("red"),this.drawPoint("red"),this.drawLine("red",this.lastPoint[this.lastPoint.length-1],this.lastPoint);var i=this.$refs.gestureTitle;i.style.color="red",i.innerHTML="请连接4个点"}else{this.drawStatusPoint("red"),this.drawPoint("red"),this.drawLine("red",this.lastPoint[this.lastPoint.length-1],this.lastPoint);var e=this.$refs.gestureTitle;e.style.color="red",e.innerHTML="密码错误"}else this.pswObj.step=1,this.pswObj.fpassword=t,this.$refs.gestureTitle.innerHTML="再次输入"},makeState:function(){if(2==this.pswObj.step){this.$refs.updatePassword.style.display="block";var t=this.$refs.gestureTitle;t.style.color="#87888a",t.innerHTML="请解锁"}else 1==this.pswObj.step?this.$refs.updatePassword.style.display="none":this.$refs.updatePassword.style.display="block"},setChooseType:function(t){this.chooseType=t,this.init()},updatePassword:function(){window.localStorage.removeItem("passwordxx"),window.localStorage.removeItem("chooseType"),this.pswObj={},this.$refs.gestureTitle.innerHTML="绘制解锁图案",this.reset()},initDom:function(){this.chooseType=Number(window.localStorage.getItem("chooseType"))||3,this.devicePixelRatio=window.devicePixelRatio||1;var t=this.$refs.canvas,s=this.width||320,i=this.height||320;t.style.width=s+"px",t.style.height=i+"px",t.height=i*this.devicePixelRatio,t.width=s*this.devicePixelRatio},init:function(){this.initDom(),this.pswObj=window.localStorage.getItem("passwordxx")?{step:2,spassword:JSON.parse(window.localStorage.getItem("passwordxx"))}:{},this.lastPoint=[],this.makeState(),this.touchFlag=!1,this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.createCircle(),this.bindEvent()},reset:function(){this.makeState(),this.createCircle()},bindEvent:function(){var t=this;this.canvas=this.$refs.canvas,this.canvas.addEventListener("touchstart",function(s){s.preventDefault();for(var i=t.getPosition(s),e=0;e<t.arr.length;e++)if(Math.abs(i.x-t.arr[e].x)<t.r&&Math.abs(i.y-t.arr[e].y)<t.r){t.touchFlag=!0,t.drawPoint(t.arr[e].x,t.arr[e].y),t.lastPoint.push(t.arr[e]),t.restPoint.splice(e,1);break}},!1),this.canvas.addEventListener("touchmove",function(s){t.touchFlag&&t.update(t.getPosition(s))},!1),this.canvas.addEventListener("touchend",function(s){t.touchFlag&&(t.touchFlag=!1,t.storePass(t.lastPoint),setTimeout(function(){t.reset()},1e3))},!1)}}}),n=r,h=(i("753a"),i("2877")),o=Object(h["a"])(n,e,a,!1,null,"77030bc0",null);s["default"]=o.exports}}]);