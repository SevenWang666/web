(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-fed32186"],{7220:function(e,t,s){},"8d2e":function(e,t,s){"use strict";var i=s("7220");s.n(i).a},a1c9:function(e,t,s){"use strict";s.r(t),s("96cf");var i,a,n,o,r,c,l=s("3b8d"),p=s("1fba"),u={mounted:function(){new p.a(this.$refs.datas,{})},data:function(){return{placeholder:"请输入账本信息说明",expenseDate:"",expenseAmount:"0.00",originTitle:!0,buttons:[{class:"button-delete",text:"删除",callback:this.delete},{class:"button-save",text:"保存",callback:this.save}],headInfo:{},companyName:"",unitName:"",respCenterName:"",amount:0,refBusValue:0,businessTypeName:"",businessTypeCode:"",moExpPoolTypeName:"",moExpPoolTypeId:0,poolValue:0,totalAmount:0,companyAmount:0,sourceTypes:[],confirmFlag:"Y",expenseDesc:"",requisitions:[],invoices:[],respCenterId:0,busRefId:0,accEntityId:0,companyId:0,unitId:0,employeeId:0,currencyCode:"",swipeBtn:[{action:"delete",text:"删除",color:"#ff3a32"}]}},created:(c=Object(l.a)(regeneratorRuntime.mark(function e(){var t,s,i,a,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,this.$post({url:"/app/expense-pool/appExpDetailQuery",para:{poolId:this.$route.query.poolId,page:1,zSize:10}});case 3:return s=e.sent,i=s.rows[0],this.companyName=i.companyName,this.expenseDesc=i.description,this.unitName=i.unitName,this.respCenterName=i.respCenterName,this.expenseDate=i.expenseDate,this.moExpPoolTypeName=sessionStorage.getItem("moExpPoolTypeName")||i.moExpPoolTypeName,this.moExpPoolTypeId=sessionStorage.getItem("moExpPoolTypeId")||i.moExpPoolTypeId,this.confirmFlag=sessionStorage.getItem("confirmFlag")||"Y",this.businessTypeName=sessionStorage.getItem("businessTypeName")||i.businessTypeName,this.amount=sessionStorage.getItem("expenseAmount")||i.amount,this.companyAmount=sessionStorage.getItem("companyAmount")||i.companyAmount,this.respCenterId=i.respCenterId,this.busRefId=i.busRefId,this.accEntityId=i.accEntityId,this.companyId=i.companyId,this.unitId=i.unitId,this.employeeId=i.employeeId,this.currencyCode=i.currencyCode,e.next=25,this.$post({url:"/app/expense-pool/appExpPoolTypeQuery",para:{page:1,zSize:10}});case 25:for(a=e.sent,i=a.rows,n=0;n<i.length;n++)t.sourceTypes.push({text:i[n].description,value:{id:i[n].moExpPoolTypeId,flag:i[n].confirmFlag}});this.queryRequisition(),this.queryInvoice();case 30:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)}),methods:{queryRequisition:(r=Object(l.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$post({url:"/app/expense-pool/expensePoolRefReqQuery",para:{poolId:this.$route.query.poolId,page:1,zSize:10}});case 2:t=e.sent,this.requisitions=t.rows;case 6:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)}),queryInvoice:(o=Object(l.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$post({url:"/app/expense-pool/expensePoolRefVatQuery",para:{poolId:this.$route.query.poolId,page:1,zSize:10}});case 2:t=e.sent,this.invoices=t.rows;case 4:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),showTitle:function(){this.originTitle=!this.originTitle},selectPoolType:function(e,t,s){var i=e[0];this.moExpPoolTypeId=i.id,this.confirmFlag=i.flag,this.moExpPoolTypeName=s[0],sessionStorage.setItem("moExpPoolTypeName",s[0]),sessionStorage.setItem("moExpPoolTypeId",i.id),sessionStorage.setItem("confirmFlag",i.flag)},poolType:function(){this.pickers||(this.pickers=this.$createPicker({title:"费用类型",data:[this.sourceTypes],onSelect:this.selectPoolType,onCancel:function(){}})),this.pickers.show()},showKeyboard:function(){var e=this;this.$createKeyboard({value:this.value,onConfirm:function(t){e.companyAmount=t,sessionStorage.setItem("companyAmount",t)}}).show()},selectType:function(){this.$router.push({name:"select_expense_ref"})},delete:(n=Object(l.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.$route.query.poolId,e.next=4,this.$post({url:"/app/exp/expense-pool/appExpPoolDel",para:{poolId:t}});case 4:e.sent,this.goBack();case 6:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),save:(a=Object(l.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={poolId:parseInt(this.$route.query.poolId),respCenterName:this.respCenterName,respCenterId:this.respCenterId,moExpPoolTypeId:parseInt(this.moExpPoolTypeId),busRefId:this.busRefId,accEntityId:this.accEntityId,companyId:this.companyId,unitId:this.unitId,employeeId:this.employeeId,currencyCode:this.currencyCode,expenseDate:this.expenseDate,amount:parseFloat(this.amount),companyAmount:parseFloat(this.companyAmount),sourceType:"MANUAL",description:this.expenseDesc,confirmFlag:this.confirmFlag},e.next=4,this.$post({url:"/app/expense-pool/submit",para:t});case 4:e.sent.success&&this.goBack();case 6:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),relateRequisition:function(){this.$router.push({name:"relate_requisition",query:{poolId:this.$route.query.poolId,moExpPoolTypeId:this.moExpPoolTypeId,busRefId:this.busRefId}})},relateInvoice:function(){var e=this.$route.query.poolId;this.$router.push({name:"relate_invoice",query:{poolId:e,employeeId:this.employeeId,accEntityId:this.accEntityId}})},onSwipeBtnClick:(i=Object(l.a)(regeneratorRuntime.mark(function e(t,s){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.$route.query.poolId,!t){e.next=6;break}return e.next=4,this.$post({url:"/app/expense-pool/expensePoolRefVatSubmit",para:{lines:[{poolId:parseInt(i),invoiceId:s.invoiceId,refId:s.refId,status:"delete"}]}});case 4:e.sent.success&&this.invoices.splice(s.index,1);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)}),goBack:function(){sessionStorage.removeItem("businessTypeName"),sessionStorage.removeItem("busRefId"),sessionStorage.removeItem("expenseAmount"),sessionStorage.removeItem("companyAmount"),sessionStorage.removeItem("moExpPoolTypeName"),sessionStorage.removeItem("moExpPoolTypeId"),sessionStorage.removeItem("confirmFlag"),sessionStorage.removeItem("reimburseExpense"),this.$router.go(-1)}},computed:{recordsData:function(){return this.ds?this.ds.getAllRecordData():""},collapseTitle:function(){return this.originTitle?"收起":"展开"},collapseMargin:function(){return this.originTitle?"0px":"12px"},showRequisition:function(){return 0!=this.poolValue&&0!=this.refBusValue},showRefVat:function(){return null!=this.headInfo.employeeId&&null!=this.headInfo.accEntityId}}},d=(s("8d2e"),s("2877")),m=Object(d.a)(u,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("au-view",{ref:"view",staticClass:"view-container",attrs:{hasHeader:!0,bottomSize:50,hasFooter:!0,hasBack:!1}},[s("div",{attrs:{slot:"left"},slot:"left"},[s("div",{staticClass:"back-btn iconfont hec-icon-fanhui",on:{click:e.goBack}})]),s("div",{attrs:{slot:"center"},slot:"center"},[e._v("费用详情")]),s("div",{ref:"datas",staticClass:"datas"},[s("au-collapse",{attrs:{titleWrapperStyle:{marginTop:"12px",marginBottom:"12px"},isReverse:!0,autoExpand:!0,collapseStyle:{backgroundColor:"#EAECEE",marginTop:e.collapseMargin},clickEffect:!1}},[s("div",{staticClass:"show-more",attrs:{slot:"title"},on:{click:e.showTitle},slot:"title"},[s("div",{staticClass:"title-wrapper"},[s("span",{staticClass:"gray-line"}),s("div",{ref:"titleText",staticClass:"title-text"},[e._v("\n              "+e._s(e.collapseTitle)+"\n            ")]),s("span",{staticClass:"gray-line"})])]),s("div",{staticClass:"content-wrapper",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"header"},[e._v("头信息")]),s("span",{staticClass:"split-line"}),s("div",{staticClass:"content-items"},[s("div",{staticClass:"content-item"},[s("div",{staticClass:"item-title"},[e._v("公司")]),s("div",{staticClass:"item-sub-title"},[e._v("\n                "+e._s(e.companyName)+"\n              ")])]),s("div",{staticClass:"content-item"},[s("div",{staticClass:"item-title"},[e._v("部门")]),s("div",{staticClass:"item-sub-title"},[e._v(e._s(e.unitName))])]),s("div",{staticClass:"content-item"},[s("div",{staticClass:"item-title"},[e._v("责任中心")]),s("div",{staticClass:"item-sub-title"},[e._v("\n                "+e._s(e.respCenterName)+"\n              ")])]),s("div",{staticClass:"content-item"},[s("div",{staticClass:"item-title"},[e._v("费用发生日期")]),s("div",{staticClass:"item-sub-title"},[e._v(e._s(e.expenseDate))])])])])]),s("div",{staticClass:"content-wrapper"},[s("div",{staticClass:"header"},[e._v("费用信息")]),s("span",{staticClass:"split-line"}),s("div",{staticClass:"content-items"},[s("div",{staticClass:"pool-type-wrapper"},[s("div",{staticClass:"item-title"},[e._v("费用池类型")]),s("div",{staticClass:"item-sub-title",on:{click:e.poolType}},[e._v("\n              "+e._s(e.moExpPoolTypeName)+"\n              "),s("i",{staticClass:"cubeic-arrow"})])]),s("div",{staticClass:"content-item"},[s("div",{staticClass:"item-title"},[e._v(e._s(e.businessTypeName))]),s("div",{staticClass:"item-sub-title",on:{click:e.selectType}},[e._v("\n              CNY "+e._s(e.amount)+"\n              "),s("i",{staticClass:"cubeic-arrow"})])]),s("div",{staticClass:"content-item"},[s("div",{staticClass:"item-title"},[e._v("公司承担金额")]),s("div",{staticClass:"item-sub-title",on:{click:e.showKeyboard}},[e._v("\n              CNY "+e._s(e.companyAmount)+"\n              "),s("i",{staticClass:"cubeic-edit"})])]),s("div",{staticClass:"margin-wrapper"}),s("div",{staticClass:"content-wrapper desc-wrapper"},[s("div",{staticClass:"header"},[e._v("账本信息说明")]),s("span",{staticClass:"split-line"}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.expenseDesc,expression:"expenseDesc"}],staticClass:"textarea",attrs:{placeholder:e.placeholder},domProps:{value:e.expenseDesc},on:{input:function(t){t.target.composing||(e.expenseDesc=t.target.value)}}})])])]),s("au-swipe",[s("div",{staticClass:"button-wrapper"},[s("div",{staticClass:"header"},[e._v("申请单关联")]),s("span",{staticClass:"split-line"}),e._l(e.requisitions,function(t,i){return s("au-swipe-item",{key:i,staticClass:"requisition-wrapper",attrs:{btns:e.swipeBtn}},[s("div",[s("div",{staticClass:"line"},[s("div",{staticClass:"number"},[e._v("\n                  "+e._s(t.expRequisitionNumber)+"\n                ")]),s("div",{staticClass:"line-num"},[e._v("行号："+e._s(t.lineNumber))])]),s("div",{staticClass:"line"},[s("div",{staticClass:"name"},[e._v("\n                  项目名称："+e._s(t.moReqItemName)+"\n                ")])]),s("div",{staticClass:"line"},[s("div",{staticClass:"payment"},[s("div",{staticClass:"code"},[e._v("\n                    "+e._s(t.paymentCurrencyCode)+"\n                  ")]),e._v("\n                   \n                  "),s("div",{staticClass:"amount"},[e._v(e._s(t.paymentPrice))])])])])])}),s("div",{staticClass:"button",on:{click:e.relateRequisition}},[s("div",{staticClass:"dotted-button"},[s("div",{staticClass:"button-content"},[s("div",{staticClass:"button-content-text"},[e._v("新增申请单")]),s("div",{staticClass:"button-content-add"},[e._v("+")])])])])],2)]),s("au-swipe",[s("div",{staticClass:"button-wrapper"},[s("div",{staticClass:"header"},[e._v("发票信息")]),s("span",{staticClass:"split-line"}),e._l(e.invoices,function(t,i){return s("au-swipe-item",{key:i,staticClass:"requisition-wrapper",attrs:{btns:e.swipeBtn},on:{"btn-click":function(s){return e.onSwipeBtnClick(!0,{invoiceId:t.invoiceId,refId:t.refId,index:i})}}},[s("div",[s("div",{staticClass:"line num"},[s("div",{staticClass:"number"},[e._v("NO."+e._s(t.invoiceNumber))]),s("div",{staticClass:"date"},[e._v(e._s(t.invoiceDate))])]),s("div",{staticClass:"line"},[s("div",{staticClass:"type-name"},[e._v(e._s(t.invoiceTypeName))])]),s("div",{staticClass:"line"},[s("div",{staticClass:"code"},[e._v("发票代码："+e._s(t.invoiceCode))])]),s("div",{staticClass:"line"},[s("div",{staticClass:"payment"},[s("div",{staticClass:"code"},[e._v("CNY")]),e._v("\n                   \n                  "),s("div",{staticClass:"amount"},[e._v(e._s(t.amount))])])])])])}),s("div",{staticClass:"button",on:{click:e.relateInvoice}},[s("div",{staticClass:"dotted-button"},[s("div",{staticClass:"button-content"},[s("div",{staticClass:"button-content-text"},[e._v("新增发票")]),s("div",{staticClass:"button-content-add"},[e._v("+")])])])])],2)])],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("div",{staticClass:"select-container"},[s("au-footer-bar",{attrs:{buttons:e.buttons}})],1)])])],1)},[],!1,null,"0f9f567e",null);t.default=m.exports}}]);